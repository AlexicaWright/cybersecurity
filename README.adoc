:name: graphs-for-cybersecurity
:long-name: Neo4j Connections: Graphs for Cybersecurity
:description: Cybersecurity, Active Directory environment auditing and analysis of possible attack paths using graph
:icon: font
:tags: Cybersecurity, ITSecurity, ActiveDirectory, Auditing, Attack Paths Analysis, AD Management
:author: Neo4j
:demodb: false
:data: true
:use-load-script: false
:use-dump-file: data/cyber-security-ad-44.dump
:zip-file: false
:use-plugin: apoc, graph-data-science
:target-db-version: 4.4
:bloom-perspective: bloom/Windows_Domains.json,bloom/Attack_Path_Analysis.json
:guide: documentation/graphs-for-cybersecurity.adoc
:model: documentation/img/model.svg
:example: documentation/img/example.svg
:data-load-image1: documentation/img/1-load-file.png
:data-load-image2: documentation/img/2-import-dump-or-create-new-dbms.png
:data-load-image3: documentation/img/3-create-new-graph-dbms.png
:attack-image: bloom.gif
:rendered-guide: https://guides.neo4j.com/sandbox/{name}/index.html
:cypher: cypher
:slides: documentation/Cybersecurity_Connections-2021.pdf
:nodes: 953
:relationships: 4890
++++
<br>
++++

== {long-name} Graph Example

Description: _{description}_

Nodes {nodes} Relationships {relationships}

.Model
image::{model}[width=750]

.Example
image::{example}[width=750]

.Bloom
image::{attack-image}[width=750]



.Example Query:
[source,cypher,role=query-example,param-name=name,param-value="HilaryOlivia226@TestCompany.Local",result-column=computer,expected-result="xxx"]
----
MATCH (u:User {name: 'HilaryOlivia226@TestCompany.Local'})-[:CAN_RDP]->(r) RETURN r.name as computer
----

=== Setup

This is for Neo4j version: {target-db-version}

ifeval::[{use-plugin} != false]

Required plugins: {use-plugin}

* https://neo4j.com/docs/graph-data-science/current/[Neo4j Graph Data Science Library for Neo4j 4.4.X]
* https://neo4j.com/developer/neo4j-apoc/[APOC for Neo4j v4.4.X]

endif::[]

ifeval::[{demodb} != false]
The database is also available on https://demo.neo4jlabs.com:7473

Username "{name}", password: "{name}", database: "{name}"
endif::[]

Rendered guide available via: `:play {rendered-guide}`

Unrendered guide: link:{guide}[]

Load graph data via the following:

In this demo, the BloodHound Tools project was used to populate a fictitious Active Directory graph in Neo4j.

We have created ready-made dump file and json data files. You can load data with any of these methods.

ifeval::[{data} != false]
==== Data files: `{data}`

Import flat files (csv, json, etc) using Cypher's https://neo4j.com/docs/cypher-manual/current/clauses/load-csv/[`LOAD CSV`], https://neo4j.com/labs/apoc/4.1/import/load-json/[LOAD JSON], https://neo4j.com/labs/apoc/[APOC library], or https://neo4j.com/developer/data-import/[other methods].
endif::[]

ifeval::[{use-dump-file} != false]
==== Dump file: `link:{use-dump-file}[]`

* Drop the file into the `Files` section of a project in Neo4j Desktop. Then choose the option to `Create new DBMS from dump` option from the file options.

* Use the neo4j-admin tool to load data from the command line with the command below.

[source,shell,subs=attributes]
----
bin/neo4j-admin load --from {use-dump-file} [--database "database"]
----

* Upload the dump file to Neo4j Aura via https://console.neo4j.io/#import-instructions
endif::[]

ifeval::[{use-load-script} != false]
==== Data load script: `{use-load-script}`

[source,shell,subs=attributes]
----
bin/cypher-shell -u neo4j -p "password" -f {use-load-script} [-d "database"]
----

Or import in Neo4j Browser by dragging or pasting the content of {use-load-script}.
endif::[]

ifeval::[{zip-file} != false]
==== Zip file

Download the zip file link:{repo}/raw/master/{name}.zip[{name}.zip] and add it as "project from file" to https://neo4j.com/developer/neo4j-desktop[Neo4j Desktop^].
endif::[]

== Presentation Materials

Slides are available here link:{slides}[]

More of a video person? The use case recording is available on YouTube.

* https://youtu.be/2O2JfqeHJR4[Recording Link]

=== Feedback

Feel free to submit issues or pull requests for improvement on this repository.


== References
* https://github.com/BloodHoundAD/BloodHound[BloodHound]

* https://ernw.de/download/BloodHoundWorkshop/ERNW_DogWhispererHandbook.pdf[Handbook PDF]

* https://github.com/voutilad/BloodHound-Tools/tree/update-to-neo4j4[Bloodhound Tools - DBCreator]

* https://en.wikipedia.org/wiki/Computer_security[Cyber Security]

* https://neo4j.com/docs/bloom-user-guide/current/bloom-perspectives/[Neo4j Bloom Persectives]

* https://neo4j.com/press-releases/neo4j-for-cybersecurity/[Neo4j for Cyber Security]

* https://cybersecurityventures.com/hackerpocalypse-cybercrime-report-2016/[Hackerpocalypse Cybercrime Report-2016]

* https://www.accenture.com/_acnmedia/pdf-96/accenture-2019-cost-of-cybercrime-study-final.pdf[Cost of Cybercrime Study]

* https://www.gartner.com/en/documents/3889055/forecast-analysis-information-security-worldwide-2q18-up[Forecast Analysis: Information Security, Worldwide]

* https://github.com/voutilad/BloodHound-Tools/tree/update-to-neo4j4[BloodHound Datacreator Library]
